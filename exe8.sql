--EX.08
USE master
CREATE DATABASE MERCADORIA
USE MERCADORIA

CREATE TABLE CLIENTE(
CODIGO				INT				NOT NULL,
NOME				VARCHAR(40)		NOT NULL,
ENDERECO			VARCHAR(50)		NOT NULL,
TELEFONE			CHAR(08)		NOT NULL,
Tel_Comercial		CHAR(08)		NULL
PRIMARY KEY (CODIGO)
)
INSERT INTO CLIENTE
VALUES
(1,'Luis Paulo','R. Xv de Novembro, 100','45657878',NULL),	
(2,'Maria Fernanda','R. Anhaia, 1098','27289098','40040090'),
(3,'Ana Claudia','Av. Voluntários da Pátria, 876','21346548',NULL),	
(4,'Marcos Henrique','R. Pantojo, 76','51425890','30394540'),
(5,'Emerson Souza','R. Pedro Álvares Cabral, 97','44236545','39389900'),
(6,'Ricardo Santos','Trav. Hum, 10','98789878',NULL)

CREATE TABLE TIPO_MERC(
CODIGO			INT					NOT NULL,
NOME			VARCHAR(12)			NOT NULL
PRIMARY KEY (CODIGO) 
)
INSERT INTO TIPO_MERC
VALUES
(10001,'Pães'),
(10002,'Frios'),
(10003,'Bolacha'),
(10004,'Clorados'),
(10005,'Frutas'),
(10006,'Esponjas'),
(10007,'Massas'),
(10008,'Molhos')

CREATE TABLE CORREDORES(
CODIGO			INT				NOT NULL,
TIPO			INT				NULL,
NOME			VARCHAR(25)		NULL
PRIMARY KEY (CODIGO)
FOREIGN KEY (TIPO)
			REFERENCES TIPO_MERC (CODIGO)
)	
INSERT INTO CORREDORES
VALUES
(101,10001,'Padaria'),
(102,10002,'Calçados'),
(103,10003,'Biscoitos'),
(104,10004,'Limpeza'),
(105,NULL,NULL),		
(106,NULL,NULL),	
(107,10007,'Congelados')

CREATE TABLE MERCADORIA(
CODIGO			INT				NOT NULL,
NOME			VARCHAR(25)		NOT NULL,
CORREDOR		INT				NOT NULL,
TIPO			INT				NOT NULL,
VALOR			NUMERIC(4,2)	NOT NULL
PRIMARY KEY (CODIGO)
FOREIGN KEY (CORREDOR)
			REFERENCES CORREDORES (CODIGO),
FOREIGN KEY (TIPO)
			REFERENCES TIPO_MERC (CODIGO)
)
INSERT INTO MERCADORIA
VALUES
(1001,'Pão de Forma',101,10001,3.5),
(1002,'Presunto',101,10002,2.0),
(1003,'Cream Cracker',103,10003,4.5),
(1004,'Água Sanitária',104,10004,6.5),
(1005,'Maçã',105,10005,0.9),
(1006,'Palha de Aço',106,10006,1.3),
(1007,'Lasanha',107,10007,9.7)

CREATE TABLE COMPRA(
NOTAF			INT			NOT NULL,
CODIGOC			INT			NOT NULL,
VALOR			INT			NOT NULL
PRIMARY KEY (NOTAF)
)
ALTER TABLE COMPRA
ADD FOREIGN KEY (CODIGOC)
			REFERENCES CLIENTE (CODIGO)

VALUES
(1234,2,200),
(2345,4,156),
(3456,6,354),
(4567,3,19)

--OP1
SELECT C.VALOR FROM COMPRA C
INNER JOIN CLIENTE CL ON C.CODIGOC = CL.CODIGO
WHERE CL.NOME = 'Luis Paulo' 
--
SELECT * FROM CLIENTE C LEFT OUTER JOIN 
COMPRA CO ON CO.CODIGOC = C.CODIGO
WHERE CO.CODIGOC IS NULL
--OP2
SELECT C.VALOR FROM COMPRA C
INNER JOIN CLIENTE CL ON C.CODIGOC = CL.CODIGO
WHERE CL.NOME = 'Marcos Henrique' 
--OP3
SELECT C.ENDERECO,C.TELEFONE FROM CLIENTE C
INNER JOIN COMPRA CO
ON CO.CODIGOC = C.CODIGO
WHERE CO.NOTAF = 4567
--OP4
SELECT MERC.VALOR FROM MERCADORIA MERC
INNER JOIN TIPO_MERC TPMERC
ON MERC.TIPO = TPMERC.CODIGO
WHERE TPMERC.NOME = 'Pães'
--OP5
SELECT C.NOME FROM CORREDORES C
INNER JOIN MERCADORIA MERC
ON C.CODIGO = MERC.CORREDOR
WHERE MERC.NOME = 'Lasanha'
--OP6
SELECT C.NOME FROM CORREDORES C
INNER JOIN MERCADORIA MERC
ON C.CODIGO = MERC.CORREDOR
INNER JOIN TIPO_MERC TPMERC
ON TPMERC.CODIGO = MERC.TIPO
WHERE TPMERC.NOME = 'clorados'